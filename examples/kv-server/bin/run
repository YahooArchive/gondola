#!/bin/bash
if [ $1 = "host1" ]; then
hostId=host1 
port=8080
debugPort=10000
elif [ $1 = "host2" ]; then
hostId=host2
port=8081
debugPort=10001
elif [ $1 = "host3" ]; then
hostId=host3
port=8082
debugPort=10002
else
  echo "Run service ";
  echo "";
  echo "Usage: $0 [host1|host2|host3]";
  exit;
fi

export hostId
export JAVA_TOOL_OPTIONS="-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=$debugPort -XX:+UnlockCommercialFeatures -XX:+FlightRecorder"
mvn jetty:run -Djetty.port=$port &
pid=$!
trap "echo 'Stopping java process...'; kill -9 $pid; wait"  SIGINT SIGTERM
wait
